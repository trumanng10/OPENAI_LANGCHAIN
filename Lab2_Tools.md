Here’s the complete **Lab 2: Tools for OpenAI (Function Calling)** guide formatted for your Google Colab course module.
No environment setup or prerequisites — it starts directly from the tool-calling implementation example.

---

# **Lab 2: Tools for OpenAI (Function Calling)**

## **Objective**

This lab introduces the concept of **Tool Calling (Function Calling)** in OpenAI models.
By the end of this lab, participants will be able to:

1. Understand how function calling enables models to interact with external systems.
2. Define callable tools in Python for dynamic data retrieval or automation.
3. Execute and integrate function call outputs into model responses using the OpenAI SDK.
4. Extend the technique to build custom tools (e.g., for weather, finance, or HR data).

---

## **Lab Steps**

### **Step 1: Understanding Tool Calling**

Tool (Function) calling gives OpenAI models controlled access to external functionalities or APIs.
The model can decide when and how to invoke these tools to retrieve data or perform actions.

**Use Cases:**

* Getting today’s weather for a specific location
* Accessing account details for a user
* Issuing a refund for a customer
* Generating custom data like a horoscope or report

Reference:

* [Function Calling Documentation](https://platform.openai.com/docs/guides/function-calling)
* [LangChain Integration](https://python.langchain.com/docs/integrations/chat/openai/)

---

### **Step 2: Create the Python Script**

In Google Colab, create a new code cell and paste the following:

```python
from openai import OpenAI
import json

client = OpenAI()

# 1. Define a list of callable tools for the model
tools = [
    {
        "type": "function",
        "name": "get_horoscope",
        "description": "Get today's horoscope for an astrological sign.",
        "parameters": {
            "type": "object",
            "properties": {
                "sign": {
                    "type": "string",
                    "description": "An astrological sign like Taurus or Aquarius",
                },
            },
            "required": ["sign"],
        },
    },
]

# 2. Define the function to perform the task
def get_horoscope(sign):
    return f"{sign}: Next Tuesday you will befriend a baby otter."

# 3. Create a conversation input
input_list = [
    {"role": "user", "content": "What is my horoscope? I am an Aquarius."}
]
```

---

### **Step 3: Send Request to the Model with Tools Defined**

```python
# 4. Send input with tool definition
response = client.responses.create(
    model="gpt-5",
    tools=tools,
    input=input_list,
)

# Save function call outputs for next requests
input_list += response.output
```

Run this cell — the model may produce a **function call suggestion** (e.g., `get_horoscope`).

---

### **Step 4: Execute the Tool Function**

```python
# 5. Execute the function logic for get_horoscope
for item in response.output:
    if item.type == "function_call":
        if item.name == "get_horoscope":
            horoscope = get_horoscope(json.loads(item.arguments))

            # Provide function result to model
            input_list.append({
                "type": "function_call_output",
                "call_id": item.call_id,
                "output": json.dumps({
                  "horoscope": horoscope
                })
            })

print("Final input:")
print(input_list)
```

---

### **Step 5: Return the Model’s Final Response**

```python
# 6. Model produces the final result based on the tool output
response = client.responses.create(
    model="gpt-5",
    instructions="Respond only with a horoscope generated by a tool.",
    tools=tools,
    input=input_list,
)

print("Final output:")
print(response.model_dump_json(indent=2))
print("\n" + response.output_text)
```

---

### **Step 6: Observe the Output**

The model now processes the function output and generates the final response.
You should see something like:
```python
# Extract text field from ResponseOutputMessage content
for item in response.output:
    if hasattr(item, 'content') and item.content:
        for content_item in item.content:
            if hasattr(content_item, 'text'):
                print(content_item.text)
```
```
Final output:
{
  "output_text": "Aquarius: Next Tuesday you will befriend a baby otter."
}
```

---

### **Step 7: Discussion and Extension**

Try modifying the example:

* Replace `get_horoscope` with a **custom function** such as:

  * `get_weather(location)`
  * `get_stock_price(symbol)`
  * `get_quote(topic)`
* Change the system instruction to alter the model’s final phrasing.
* Observe how the model dynamically decides when to use the tool.

---

### **Lab Completion**

**End of Lab 2.**
You have successfully built and executed a function-calling example in OpenAI using Google Colab.
This lab demonstrates how **AI Agents** interact with external tools and data in a secure, controlled manner — the foundation of modern Agentic AI workflows.

---

Would you like me to add **Lab 3: Custom Tool Building (e.g., Weather or Finance Tool)** next, continuing this series?
